@using Microsoft.AspNetCore.Identity
@using LearnStack.Data

@inject SignInManager<ApplicationUser> SignInManager

<div class="manage-nav">
    <NavLink class="manage-nav-link" href="Account/Manage" Match="NavLinkMatch.All">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
        Profile
    </NavLink>
    <NavLink class="manage-nav-link" href="Account/Manage/Email">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
        Email
    </NavLink>
    <NavLink class="manage-nav-link" href="Account/Manage/ChangePassword">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
        Password
    </NavLink>
    @if (hasExternalLogins)
    {
        <NavLink class="manage-nav-link" href="Account/Manage/ExternalLogins">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>
            External logins
        </NavLink>
    }
    <NavLink class="manage-nav-link" href="Account/Manage/TwoFactorAuthentication">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
        Two-factor auth
    </NavLink>
    <NavLink class="manage-nav-link" href="Account/Manage/Passkeys">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/></svg>
        Passkeys
    </NavLink>
    <NavLink class="manage-nav-link" href="Account/Manage/PersonalData">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
        Personal data
    </NavLink>
</div>

<style>
    .manage-nav {
        display: flex;
        flex-direction: column;
        gap: 4px;
        background: white;
        border-radius: 16px;
        border: 1px solid #e2e8f0;
        padding: 8px;
        box-shadow: 0 4px 6px -1px rgba(15, 23, 42, 0.05), 0 2px 4px -1px rgba(15, 23, 42, 0.03);
    }

    .manage-nav-link {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px 14px;
        border-radius: 10px;
        color: #475569;
        text-decoration: none;
        font-weight: 500;
        font-size: 0.9rem;
        transition: all 0.15s ease;
    }

    .manage-nav-link:hover {
        background-color: #f1f5f9;
        color: #0f172a;
    }

    .manage-nav-link.active {
        background: linear-gradient(135deg, #4f46e5, #6366f1);
        color: white;
        box-shadow: 0 2px 4px rgba(79, 70, 229, 0.2);
    }

    .manage-nav-link svg {
        flex-shrink: 0;
    }

    @@media (max-width: 768px) {
        .manage-nav {
            flex-direction: row;
            overflow-x: auto;
            padding: 6px;
            gap: 2px;
        }

        .manage-nav-link {
            white-space: nowrap;
            padding: 8px 12px;
            font-size: 0.85rem;
        }

        .manage-nav-link svg {
            display: none;
        }
    }
</style>

@code {
    private bool hasExternalLogins;

    protected override async Task OnInitializedAsync()
    {
        hasExternalLogins = (await SignInManager.GetExternalAuthenticationSchemesAsync()).Any();
    }

}